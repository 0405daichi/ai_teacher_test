# spec/models/question_vector_spec.rb

require 'rails_helper'

RSpec.describe QuestionVector, type: :model do
  describe '.cosine_similarity' do
    let(:vector_a) { [0.040695388,
      0.09941118,
      0.11849432,
      0.024346767,
      0.053672694,
      0.002543393,
      0.0563317,
      0.0867379,
      -0.0025185037,
      0.011031561,
      0.07530308,
      -0.072979964,
      0.04176286,
      -0.07159793,
      -0.12319061,
      -0.019463683,
      -0.047170594,
      -0.019906007,
      -0.10137411,
      0.03924583,
      0.04968961,
      -0.042359386,
      0.04628777,
      0.07557954,
      0.021859115,
      -0.0136102615,
      0.01634153,
      0.06995195,
      0.100980625,
      0.0060448875,
      -0.012325102,
      0.034887597,
      0.050022643,
      -0.081422016,
      0.018332593,
      -0.00077747204,
      -0.07768302,
      -0.05232796,
      -0.040139914,
      0.0038115308,
      0.02427992,
      -0.03971349,
      0.052162237,
      0.010753625,
      -0.017612305,
      0.007761538,
      -0.047861256,
      -0.025392804,
      -0.010197598,
      -0.032148894,
      -0.08557423,
      -0.02095641,
      -0.016020482,
      -0.0827271,
      -0.04427854,
      -0.086424746,
      -0.015880652,
      -0.06925134,
      -0.048437536,
      -0.0029610305,
      0.015877306,
      -0.05845997,
      0.059912644,
      0.018037869,
      0.014003769,
      0.036652617,
      0.105440594,
      -0.029770773,
      -0.073467135,
      -0.018687831,
      -0.00414924,
      -0.010126902,
      0.006084924,
      -0.07024527,
      -0.0031797139,
      -0.046292387,
      0.012936259,
      0.0023314485,
      -0.027719313,
      0.030457854,
      0.009154484,
      -0.08037141,
      -0.083646834,
      0.03515302,
      -0.0755466,
      0.042681012,
      -0.013600933,
      0.080085196,
      0.010491291,
      0.049736943,
      -0.056115385,
      -0.01618643,
      -0.08545642,
      -0.07513451,
      -0.10519549,
      0.06148055,
      -0.004329471,
      -0.092358746,
      0.0010403311,
      -0.0063930256,
      0.03612548,
      0.032022092,
      0.04519827,
      0.10293961,
      -0.07015865,
      -0.037554774,
      0.02170344,
      -0.03403883,
      0.0036649713,
      -0.007738728,
      -0.024099134,
      -0.15177381,
      -0.004066094,
      -0.08829533,
      0.048401233,
      0.05656187,
      0.11500464,
      0.0033683612,
      -0.06969694,
      -0.04319472,
      0.081405446,
      -0.007324444,
      -0.071757436,
      -0.014140791,
      -0.08697672,
      -0.017606067,
      0.053728156,
      4.6055395e-33,
      -0.05825587,
      -1.7371722e-05,
      -0.026939124,
      -0.019292716,
      -0.10913166,
      0.0070103784,
      -0.018024812,
      0.03600678,
      -0.066504635,
      -0.018004248,
      0.027640665,
      0.07172884,
      0.0020934418,
      -0.057401605,
      -0.02205453,
      -0.016474007,
      0.015359726,
      -0.0049630017,
      0.045892183,
      0.0288669,
      0.012413937,
      -0.13061616,
      -0.05380383,
      0.040626995,
      0.027225424,
      -0.09061827,
      0.009988577,
      0.015962938,
      0.0038557323,
      -0.014112487,
      0.014752472,
      -0.011751091,
      0.0018985403,
      0.065457694,
      -0.023958184,
      0.025093673,
      0.043545272,
      0.13420798,
      0.06317002,
      0.05856238,
      0.01988218,
      0.004464682,
      0.009314727,
      -0.06333594,
      0.10802974,
      -0.023465095,
      -0.0097138,
      -0.022380518,
      0.02287842,
      0.0032860534,
      0.053961504,
      -0.010572331,
      -0.018040882,
      0.07442675,
      0.122174785,
      -0.030705234,
      -0.053648036,
      0.023789244,
      -0.106989324,
      -0.027063489,
      0.014488053,
      -0.0074385745,
      -0.07011804,
      0.027776739,
      -0.03224362,
      0.033617906,
      0.0118640885,
      0.0058228537,
      -0.027411899,
      -0.00391108,
      -0.054427557,
      -0.036449805,
      0.011073365,
      0.018435024,
      -0.023786835,
      -0.015551952,
      -0.0659824,
      0.039798755,
      0.018172745,
      0.022400228,
      -0.013071018,
      -0.06470197,
      0.030379206,
      0.027524382,
      0.0069997665,
      0.014230518,
      0.04846336,
      -0.10274102,
      0.016215196,
      -0.0058765383,
      -0.11153602,
      -0.0070691695,
      0.051773172,
      0.13104747,
      -0.017957384,
      -5.886226e-33,
      0.0602509,
      0.07844236,
      0.01819066,
      -0.008836302,
      -0.01676167,
      0.0165981,
      0.048075292,
      0.12481511,
      -0.04625574,
      -0.00626319,
      0.085554115,
      -0.012194802,
      0.004184757,
      -0.0023736798,
      0.042015437,
      0.031092782,
      0.0013994866,
      0.045437407,
      -0.060856346,
      -0.0062194304,
      -0.008030285,
      -0.019016493,
      0.027436437,
      -0.015720056,
      0.03406772,
      0.03343203,
      0.065555826,
      -0.023214713,
      -0.0007107017,
      -0.054903477,
      -0.03623536,
      -0.026964542,
      0.011112953,
      0.03807964,
      0.0097365035,
      -0.03125253,
      0.04473195,
      -0.0058299797,
      0.007275679,
      0.028652882,
      0.005874167,
      0.08199414,
      0.087317966,
      -0.05826538,
      -0.010386106,
      0.018213563,
      -0.03690542,
      -0.032175332,
      -0.027539609,
      0.0037168087,
      0.0736771,
      -0.029520478,
      0.011992565,
      0.048938196,
      -0.012373379,
      0.1058137,
      0.04230122,
      0.04084619,
      -0.036200415,
      -0.017274976,
      -0.059621226,
      0.02026964,
      0.04316529,
      0.010119054,
      0.048426684,
      -0.025942247,
      0.017041212,
      0.028494133,
      -0.038875263,
      -0.010372976,
      0.008462489,
      0.046342473,
      -0.006760812,
      -0.0076595102,
      -0.033478796,
      0.030750131,
      -0.054617014,
      0.039518856,
      0.08124971,
      0.045851234,
      -0.014412969,
      0.08980968,
      0.039787352,
      -0.028057337,
      -0.10605035,
      -0.116288446,
      -0.0687299,
      0.040609684,
      -0.033159178,
      0.0074174195,
      0.011848409,
      0.089211784,
      0.013206605,
      -0.08727554,
      0.0545303,
      -2.1868583e-08,
      -0.032368604,
      -0.06905733,
      -0.060416162,
      -0.05004053,
      0.053080644,
      0.022363296,
      -0.12491455,
      0.029610168,
      0.015789423,
      -0.023480138,
      0.0540036,
      0.06997691,
      -0.042891055,
      0.05633337,
      -0.04642536,
      0.023309672,
      -0.0011239722,
      0.038319655,
      0.059652727,
      -0.04913116,
      0.06007628,
      -0.10399058,
      0.021430131,
      -0.04011149,
      -0.07686751,
      0.0328102,
      -0.05497721,
      0.026776547,
      -0.078750595,
      0.020390438,
      0.0038058145,
      0.003293404,
      0.047705512,
      -0.025280727,
      -0.08172338,
      -0.045537036,
      0.02411337,
      0.015746096,
      -0.05017328,
      0.12691946,
      0.06830741,
      0.0009412179,
      -0.0046764724,
      -0.01415547,
      0.069123544,
      -0.105688244,
      0.025040425,
      0.039285302,
      0.01255831,
      0.0070284232,
      -0.029168744,
      0.05459542,
      0.01067624,
      -0.02744577,
      -0.04462877,
      -0.002004266,
      0.04651662,
      0.060844716,
      -0.035243444,
      -0.052591767,
      0.025472267,
      0.11745562,
      -0.023597585,
      0.020158805] }  # 実際のベクトル要素を追加
    let(:vector_b) { [0.0075313225,
      0.09444758,
      0.10173709,
      0.02441696,
      0.0673512,
      0.007374748,
      0.06561061,
      0.061733104,
      -0.0016852812,
      0.012086356,
      0.06924853,
      -0.07102474,
      0.056955814,
      -0.08727948,
      -0.14415035,
      -0.021902721,
      -0.06679238,
      -0.016468368,
      -0.060323536,
      0.04610465,
      0.026393672,
      -0.026079688,
      0.06374805,
      0.06841995,
      0.021694468,
      -0.0024237032,
      0.029535701,
      0.08771803,
      0.06915214,
      0.0037827303,
      0.0059749796,
      0.007923448,
      0.019931244,
      -0.06623247,
      0.017398184,
      -0.0057413606,
      -0.05492902,
      -0.051207833,
      -0.05099904,
      -0.0058783717,
      0.025546044,
      -0.056793425,
      0.07167015,
      -0.017190948,
      -0.009232602,
      0.0026122986,
      -0.06288823,
      -0.026414253,
      0.017762065,
      -0.038178425,
      -0.087720595,
      -0.045201566,
      -0.010074485,
      -0.073725924,
      -0.028662812,
      -0.08070525,
      0.0052700588,
      -0.07439614,
      -0.06957354,
      -0.022299867,
      0.01361906,
      -0.04483509,
      0.064513616,
      0.010099836,
      0.0010430272,
      0.054023694,
      0.08012284,
      -0.053717438,
      -0.058758557,
      -0.014544062,
      -0.03775287,
      -0.024943208,
      -0.0016531486,
      -0.077376194,
      0.020731159,
      -0.021159165,
      0.0032155022,
      -0.017145466,
      -0.026680887,
      0.011003627,
      0.00789882,
      -0.08594015,
      -0.06902341,
      0.018331254,
      -0.06203413,
      0.046029437,
      0.0038355142,
      0.092647016,
      -0.011003988,
      0.058851346,
      -0.05216459,
      -0.03142605,
      -0.078454226,
      -0.092755236,
      -0.11478853,
      0.05876793,
      -0.0072644562,
      -0.092119895,
      0.015918719,
      -0.018896906,
      0.030224409,
      0.03539711,
      0.04458795,
      0.08535709,
      -0.09264666,
      -0.031176448,
      0.020588547,
      -0.0075388122,
      0.012596621,
      -0.030124495,
      -0.028959008,
      -0.1671752,
      -0.024861045,
      -0.08056111,
      0.03473415,
      0.050358653,
      0.124690995,
      -0.0071072066,
      -0.05987065,
      -0.051597133,
      0.08331623,
      -0.009087707,
      -0.073973015,
      -0.01288298,
      -0.08259434,
      -0.012116703,
      0.06446467,
      3.613405e-33,
      -0.05199669,
      -0.014478914,
      -0.046566132,
      -0.022809029,
      -0.12574594,
      0.024064962,
      -0.00046581458,
      0.039564345,
      -0.04976565,
      -0.014980674,
      -0.0022581832,
      0.086984046,
      0.024815205,
      -0.07226006,
      -0.022508973,
      -0.017735818,
      0.00525181,
      0.0072464054,
      0.050909173,
      6.318227e-05,
      0.027947402,
      -0.11178478,
      -0.030541215,
      0.046032056,
      0.008285654,
      -0.074176915,
      -0.0031609049,
      0.039827652,
      -0.0049923086,
      -0.02595883,
      0.0041825483,
      -0.006630923,
      0.017542956,
      0.061724965,
      -0.022130875,
      0.029585166,
      0.052956775,
      0.12197267,
      0.09064761,
      0.07492813,
      0.057901517,
      0.00012943553,
      0.021100799,
      -0.058716387,
      0.08565813,
      -0.0077949855,
      -0.030217547,
      -0.018126536,
      0.035517607,
      0.036420904,
      0.052865755,
      -0.023513101,
      -0.0280836,
      0.08037483,
      0.10112513,
      -0.03077528,
      -0.05583264,
      0.027141793,
      -0.088396214,
      -0.056329157,
      0.004638513,
      -0.017435543,
      -0.06390033,
      0.01055105,
      -0.04424301,
      0.05296112,
      0.029625576,
      0.0105673345,
      -0.034237962,
      0.0064423536,
      -0.052538715,
      -0.025193933,
      0.035482004,
      0.017928747,
      -0.01659478,
      -0.00078511745,
      -0.09209681,
      0.04639862,
      0.012371749,
      0.013648442,
      -0.011027906,
      -0.057001907,
      0.026267365,
      0.019574689,
      0.010723924,
      0.023020593,
      0.027295617,
      -0.102816686,
      0.009418886,
      0.0114644375,
      -0.0770277,
      -0.021256628,
      0.06055093,
      0.13522561,
      -0.02203223,
      -5.1905617e-33,
      0.042684723,
      0.07454375,
      0.029612258,
      -0.03008463,
      -0.010828008,
      0.018923271,
      0.030460613,
      0.07130283,
      -0.04146253,
      -0.011493422,
      0.06516917,
      -0.010164633,
      0.03684318,
      -0.0053264657,
      0.032988932,
      0.020271115,
      -0.008751617,
      0.056835163,
      -0.07712899,
      -0.0013626469,
      -0.0070802113,
      -0.02516084,
      0.022495372,
      0.009318626,
      0.026665764,
      0.038367376,
      0.052378938,
      -0.0206135,
      0.026905524,
      -0.06281059,
      -0.024161903,
      -0.0077234264,
      0.06131897,
      0.060386505,
      0.023423927,
      -0.019564115,
      0.05727272,
      0.002338272,
      0.015456434,
      0.056361157,
      0.0034226787,
      0.08843383,
      0.051023897,
      -0.038231213,
      -0.006154294,
      0.04566097,
      -0.048066206,
      -0.0057861507,
      -0.032226406,
      0.022205576,
      0.051538583,
      -0.01693336,
      0.0002130884,
      0.018121956,
      -0.015540489,
      0.13830559,
      0.03958944,
      0.04132794,
      -0.0398505,
      -0.009378781,
      -0.04305512,
      0.055645593,
      0.05841593,
      0.022473926,
      0.04913209,
      -0.0294907,
      0.024324842,
      0.01768122,
      -0.036443565,
      0.0067182877,
      -0.011161227,
      0.040007483,
      -0.00456605,
      -0.027074091,
      -0.009165658,
      0.027829409,
      -0.075342216,
      0.05195855,
      0.09641733,
      0.06463456,
      -0.029588029,
      0.095194444,
      0.055879463,
      -0.01251996,
      -0.11443165,
      -0.086088635,
      -0.06436846,
      0.035136,
      -0.01763882,
      -0.035521086,
      0.03089672,
      0.092670575,
      -0.0020786512,
      -0.07708051,
      0.08696912,
      -1.9201968e-08,
      -0.021412075,
      -0.054152716,
      -0.08306989,
      -0.03347255,
      0.04666266,
      -0.0065290607,
      -0.13223417,
      0.017155452,
      0.013998959,
      -0.027388653,
      0.07903654,
      0.048883762,
      -0.04126024,
      0.03957066,
      -0.047608808,
      0.008256815,
      -0.01994429,
      0.042704012,
      0.04456959,
      -0.043223687,
      0.06934954,
      -0.10905614,
      0.014846288,
      -0.04817468,
      -0.048744272,
      0.020007689,
      -0.08085164,
      0.008929537,
      -0.047813028,
      0.033274543,
      7.9623016e-05,
      -0.021061793,
      0.041835904,
      0.0056436933,
      -0.07525796,
      -0.0591084,
      0.047028564,
      0.022791749,
      -0.061036028,
      0.13989569,
      0.08999664,
      0.012920627,
      -0.027190123,
      -0.014758099,
      0.043098975,
      -0.08079705,
      0.00942393,
      0.048785966,
      -0.013967431,
      0.014252429,
      -0.031494323,
      0.048127275,
      0.008853721,
      -0.0077142147,
      -0.047848575,
      -0.02098044,
      0.017476317,
      0.07257337,
      -0.035888113,
      -0.03612487,
      0.0060441736,
      0.110190734,
      -0.01110683,
      0.03350944] }  # 実際のベクトル要素を追加

    it 'calculates cosine similarity correctly' do
      similarity = QuestionVector.cosine_similarity(vector_a, vector_b)
      expect(similarity).to eq(1.0)
    end
  end
end
